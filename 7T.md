
# 🎒 توضیح الگوریتم کوله‌پشتی در مسئله گراف جادویی

در مسئله‌ی گراف جادویی، هدف این است که از بین یال‌های داده‌شده، زیرمجموعه‌ای انتخاب کنیم که:

- مجموع هزینه‌های یال‌های انتخاب‌شده **از مقدار \( B \)** بیشتر نشود.
- مجموع ارزش جادویی یال‌های انتخاب‌شده **حداکثر ممکن** باشد.
- و مهم‌تر از همه، مجموعه یال‌ها **جنگل** تشکیل دهد (یعنی دور نداشته باشد).


---

## 🎒 الگوریتم کوله‌پشتی ۰/۱

در مسئله کوله‌پشتی کلاسیک ۰/۱، ما یک کوله‌پشتی با ظرفیت \( B \) داریم و چند آیتم. هر آیتم:

- یک **وزن (هزینه)** دارد.
- یک **ارزش (profit)** دارد.

هدف این است که تعدادی از آیتم‌ها را انتخاب کنیم، به‌گونه‌ای که:

- مجموع وزن آیتم‌ها بیشتر از ظرفیت نباشد.
- مجموع ارزش آیتم‌ها بیشینه شود.

---

## 🧩 ارتباط با مسئله‌ی گراف جادویی

در این مسئله:

| کوله‌پشتی کلاسیک         | گراف جادویی                  |
|--------------------------|------------------------------|
| آیتم                     | یک یال                       |
| وزن آیتم                 | `cost[i]` (هزینه یال)        |
| ارزش آیتم                | `magicvalue[i]` (ارزش جادویی)|
| ظرفیت کوله‌پشتی         | `B`                          |
| هدف                      | حداکثر کردن مجموع ارزش جادویی |

بنابراین، می‌توان این مسئله را با استفاده از الگوریتم کوله‌پشتی حل کرد.

---

## 🧮 پیاده‌سازی الگوریتم دینامیک

ما از یک ماتریس `dp[i][j]` استفاده می‌کنیم که نشان می‌دهد:

> بیشترین مجموع ارزش جادویی با استفاده از **اولین i یال** و **بودجه j** چقدر است.

### مراحل:

1. مقداردهی اولیه: تمام مقادیر `dp` را با -1 مقداردهی می‌کنیم.
2. سپس برای هر یال، بررسی می‌کنیم:
   - اگر بودجه فعلی `j` برای انتخاب این یال کافی است (`j - cost[i] >= 0`)
   - و اگر حالت قبلی (`dp[i-1][j-cost[i]]`) معتبر است
   - آنگاه می‌توانیم این یال را انتخاب کنیم و مقدار `dp[i][j]` را به‌روز کنیم.
3. در پایان، بیشترین مقدار در جدول `dp` برابر با پاسخ مسئله است.

---

## 📌 نکته مهم

در این روش فقط به بودجه و بیشینه‌سازی ارزش توجه شده است. اگر بخواهیم تضمین کنیم که مجموعه یال‌های انتخاب‌شده **جنگل** تشکیل دهند (یعنی دور نداشته باشند)، باید الگوریتم را با **Union-Find (DSU)** ترکیب کنیم.

---

## 🧾 خلاصه

- الگوریتم کوله‌پشتی یک ابزار مؤثر برای بررسی محدودیت بودجه در این مسئله است.
- مدل‌سازی هزینه‌ها و ارزش جادویی یال‌ها مشابه وزن و ارزش آیتم‌های کلاسیک کوله‌پشتی است.
- برای اطمینان از عدم وجود دور (جنگل بودن)، باید بررسی اضافی انجام شود.
